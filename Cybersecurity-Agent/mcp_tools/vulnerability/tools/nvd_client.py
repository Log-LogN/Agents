import os
import requests

NVD_URL = "https://services.nvd.nist.gov/rest/json/cves/2.0"


def fetch_cves(keyword: str, limit: int = 5):
    headers = {}
    api_key = os.getenv("NVD_API_KEY")
    if api_key:
        headers["apiKey"] = api_key

    params = {
        "keywordSearch": keyword,
        "resultsPerPage": limit,
    }

    resp = requests.get(NVD_URL, headers=headers, params=params, timeout=15)
    resp.raise_for_status()
    return resp.json()
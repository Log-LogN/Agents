import requests

OSV_URL = "https://api.osv.dev/v1/query"


def query_osv(package: str, version: str, ecosystem: str):
    payload = {
        "package": {
            "name": package,
            "ecosystem": ecosystem
        },
        "version": version
    }

    resp = requests.post(OSV_URL, json=payload, timeout=15)
    resp.raise_for_status()
    return resp.json()